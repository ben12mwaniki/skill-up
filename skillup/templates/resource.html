<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>resource-info</title>
    {% load static %}
    <link rel="icon" href="{% static 'favicon.ico' %}" type="image/x-icon">
    <link href="{% static 'resource.css' %}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <button class="toggle-button" onclick="toggleMode()">Toggle Dark/Light Mode</button>
    
    <div class="content" >
        <div class="d-flex header-container justify-content-center">
            <h3>{{resource.title}} stars: {{resource.star_rating}} </h3> 
        </div>
        <!--★★★✰✰(23) To be used for stars   -->
        <div class="resource">
            <div>
                <b>Type: </b> {{resource.type}}
            </div>
              <div>
                 <b>Author:</b>  {{resource.author}}
              </div>
              <div>
               <b>Link:</b>   <a href="{{resource.link}}"> visit</a> 
              </div>
              <div>
                <b>Subjects:</b>   {{resource.subjects}}
              </div>
              <div>
                <b>Description:</b>
                <div>
                    {{resource.description}}
                </div>
                 
              </div>

              <div class="d-flex justify-content-between">  
                <button class="btn-submit" onclick="saveResource()" >Save</button>
                
                {% if user.is_authenticated %}
                    <button class="btn-submit" onclick="rateResource()">Rate</button>
                {% endif %} 
            </div>
    
        </div>
        

            <div class="comment">
                <h4>Comments</h4>

                <div class="comment-header">
                    <div> John Doe <em> (2 days ago)</em> </div>
                   
                </div>
                <div class="comment-body">
                    This is a great resource! I learned a lot from it.
                </div> 
                
                <h6>
                    <label for="comment">Add comment:</label>
                </h6>
                <textarea name="comment" cols="60" rows="5"> </textarea>
                <button class="btn-submit">Submit</button>
                
            </div>     
           
    </div>

    <script>
        function toggleMode() {
            document.body.classList.toggle('dark-mode');

            // Toggle button and resource elements between light and dark mode
            const btnSubmit = document.querySelector('.btn-submit');
            btnSubmit.classList.toggle('light-mode');
            btnSubmit.classList.toggle('dark-mode');
        }
        function saveResource() {
            fetch(window.location.href, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'   
                },
                body: JSON.stringify({
                    'action': 'save'
                })
            }).then(response => {
                if (response.ok) {
                    window.location.href = '/profile';
                } else if (response.status === 401) {
                    window.location.href = '/login/?next=' + window.location.pathname;
                } else{
                    alert('Resource not saved'); 
                }
            });
        }
        function rateResource() {
            console.log('Resource rated');
            console.log(window.location.href);
            // Rate resource
        }
        function addComment() {
            console.log('Comment added');
            // Add comment
        }
    </script>
</body>
</html>
